## 其他简答题

### 1. 如何将如下的`JSON`正确解析成 `Object`

```json
{
  "userId": 111323290434354540545
}
```

`userId` 是一个数字类型，如果直接使用 `JSON` 的 `API` 转换会出现精度问题。应该使用 `BigInt` 原始类型进行处理

> 实际开发遇到过后端直接返回个数字类型 ID 给前端展示

直接上代码

```js
let jsonStr = '{"userId": 111323290434354540545}'

// ECMAScript 6 -> 9.BigInt https://es6.ruanyifeng.com/#docs/number

// 先转换成字符串，精度和 IEEF 和 浏览器支持程度有关（早期开发时发现，实际开发时发现不同浏览器不同），可以写对应正则。手打非 GPT 生成
jsonStr = jsonStr.replace(/"\w+":\s*\d+/g, match => match.replace(/\d+/, n => `"${n}"`))

const jsonObj = JSON.parse(jsonStr)

// 需要转换的键值
;['userId'].forEach(key => {
  jsonObj[key] = BigInt(jsonObj[key])
})

// { userId: 111323290434354540545n }
console.log(jsonObj)

// 使用第三方插件，如：json-bigint
```

### 2. 前端需要*稳定*每隔`1s`向服务端请求`API`, 请问如何实现？

`setInterval` 能间隔`1s`执行一次服务请求

> 可能存在请求次数过多失败(如实际情景：大文件分片上传，占据太多请求次数，占用资源时间过长)

不满足稳定？ 使用 `Web Worker` 可以？

`worker 脚本` + `setInterval`

### 3. 什么情况下，你会为你的项目引入状态管理库，比如`Redux`, `Pinia`, 可以简述一下起到了什么作用么？

1. 生产者/消费者，Props 模式已无法满足需求
2. 业务复杂程度过于复杂(异步操作处理过多)
3. 组件解耦；页面交互过多，难以维护

作用？

1. 实现组件数据共享和通讯
2. 逻辑重用和维护
3. 存储集中
4. 缓存和持久化

### 4. 为什么`ESM`与`CJS`不能兼容？

- 并不是完全不兼容，一些情况部分是可兼容的。 比如：`required`

真的问题是设计和实现存在差异。主要体现在 `ESM` 采用了静态解析 `CJS` 采用动态加载。

| ESM | CJS |
| --- | --- |
| `imoprt`、`export`模块导入(可多个导出，只能默认一个 `export default`) | `required`、`module.exports`（只能一个 `module.exports`） |
| 支持静态解析(执行前被确定) 更方便 tree shaking | 运行时才确定 |
| 异步加载 | 同步加载(会阻塞进程) |
